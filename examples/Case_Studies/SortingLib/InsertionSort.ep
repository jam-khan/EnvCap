@pure module InsertionSort

require Listutils;

function insert(sorted: [Int], elem: Int) : [Int] {
    match sorted of
        case []         => { [elem]<Int> }
        case (x:xs)     => {
            if (elem <= x) 
            then concat([elem]<Int>, sorted)
            else concat([x]<Int>, insert(xs, elem))
        }
};

function insertionSort(ls: [Int]) : [Int] {
    match ls of
        case []         => { []<Int> }
        case (x:xs)     => { insert(insertionSort(xs), x) }
};
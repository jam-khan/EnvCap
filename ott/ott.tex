% generated by Ott 0.34 from: fiplus.ott compilation.ott
\newcommand{\ottdrule}[4][]{{\displaystyle\frac{\begin{array}{l}#2\end{array}}{#3}\quad\ottdrulename{#4}}}
\newcommand{\ottusedrule}[1]{\[#1\]}
\newcommand{\ottpremise}[1]{ #1 \\}
\newenvironment{ottdefnblock}[3][]{ \framebox{\mbox{#2}} \quad #3 \\[0pt]}{}
\newenvironment{ottfundefnblock}[3][]{ \framebox{\mbox{#2}} \quad #3 \\[0pt]\begin{displaymath}\begin{array}{l}}{\end{array}\end{displaymath}}
\newcommand{\ottfunclause}[2]{ #1 \equiv #2 \\}
\newcommand{\ottnt}[1]{\mathit{#1}}
\newcommand{\ottmv}[1]{\mathit{#1}}
\newcommand{\ottkw}[1]{\mathbf{#1}}
\newcommand{\ottsym}[1]{#1}
\newcommand{\ottcom}[1]{\text{#1}}
\newcommand{\ottdrulename}[1]{\textsc{#1}}
\newcommand{\ottcomplu}[5]{\overline{#1}^{\,#2\in #3 #4 #5}}
\newcommand{\ottcompu}[3]{\overline{#1}^{\,#2<#3}}
\newcommand{\ottcomp}[2]{\overline{#1}^{\,#2}}
\newcommand{\ottgrammartabular}[1]{\begin{supertabular}{llcllllll}#1\end{supertabular}}
\newcommand{\ottmetavartabular}[1]{\begin{supertabular}{ll}#1\end{supertabular}}
\newcommand{\ottrulehead}[3]{$#1$ & & $#2$ & & & \multicolumn{2}{l}{#3}}
\newcommand{\ottprodline}[6]{& & $#1$ & $#2$ & $#3 #4$ & $#5$ & $#6$}
\newcommand{\ottfirstprodline}[6]{\ottprodline{#1}{#2}{#3}{#4}{#5}{#6}}
\newcommand{\ottlongprodline}[2]{& & $#1$ & \multicolumn{4}{l}{$#2$}}
\newcommand{\ottfirstlongprodline}[2]{\ottlongprodline{#1}{#2}}
\newcommand{\ottbindspecprodline}[6]{\ottprodline{#1}{#2}{#3}{#4}{#5}{#6}}
\newcommand{\ottprodnewline}{\\}
\newcommand{\ottinterrule}{\\[5.0mm]}
\newcommand{\ottafterlastrule}{\\}
\newcommand{\ottmetavars}{
\ottmetavartabular{
 $ \ottmv{tvar} ,\, \ottmv{X} ,\, \ottmv{Y} ,\, \ottmv{Z} $ & \ottcom{type variable name} \\
 $ \ottmv{var} ,\, \ottmv{x} ,\, \ottmv{y} ,\, \ottmv{z} ,\, \ottmv{this} $ & \ottcom{variable name} \\
 $ \ottmv{label} ,\, \ell $ & \ottcom{label name} \\
}}

\newcommand{\otttyp}{
\ottrulehead{\ottnt{typ}  ,\ \ottnt{A}  ,\ \ottnt{B}  ,\ \ottnt{C}}{::=}{\ottcom{types}}\ottprodnewline
\ottfirstprodline{|}{ \top }{}{}{}{\ottcom{top type}}\ottprodnewline
\ottprodline{|}{ \bot }{}{}{}{\ottcom{bottom type}}\ottprodnewline
\ottprodline{|}{ \mathbb{Z} }{}{}{}{\ottcom{base type}}\ottprodnewline
\ottprodline{|}{\ottmv{X}}{}{}{}{\ottcom{type variable}}\ottprodnewline
\ottprodline{|}{\ottnt{A}  \rightarrow  \ottnt{B}}{}{}{}{\ottcom{function type}}\ottprodnewline
\ottprodline{|}{ \forall  \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{B} }{}{}{}{\ottcom{universal type}}\ottprodnewline
\ottprodline{|}{\forall \, \ottmv{X}  \ottsym{*}  \ottnt{A}  \ottsym{.}  \ottnt{B}}{}{}{}{\ottcom{universal type}}\ottprodnewline
\ottprodline{|}{\ottsym{\{}  \ell  \ottsym{:}  \ottnt{A}  \ottsym{\}}}{}{}{}{\ottcom{record type}}\ottprodnewline
\ottprodline{|}{\ottnt{A}  \, \& \,  \ottnt{B}}{}{}{}{\ottcom{intersection type}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottnt{A}  \ottsym{)}} {\textsf{S}}{}{}{}}

\newcommand{\ottord}{
\ottrulehead{\ottnt{ord}  ,\ A^\circ  ,\ B^\circ  ,\ C^\circ}{::=}{\ottcom{ordinary types}}\ottprodnewline
\ottfirstprodline{|}{ \top }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \bot }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \mathbb{Z} }{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{X}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{A}  \rightarrow  B^\circ}{}{}{}{}\ottprodnewline
\ottprodline{|}{ \forall  \ottmv{X} \!*\! \ottnt{A} .\; B^\circ }{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{\{}  \ell  \ottsym{:}  A^\circ  \ottsym{\}}}{}{}{}{}}

\newcommand{\ottexp}{
\ottrulehead{\ottnt{exp}  ,\ \ottnt{e}}{::=}{\ottcom{expressions}}\ottprodnewline
\ottfirstprodline{|}{\ottsym{\{\}}}{}{}{}{\ottcom{top value}}\ottprodnewline
\ottprodline{|}{ n }{}{}{}{\ottcom{base literal}}\ottprodnewline
\ottprodline{|}{\ottmv{x}}{}{}{}{\ottcom{variable}}\ottprodnewline
\ottprodline{|}{ \ottkw{fix} \, \ottmv{x} \!:\! \ottnt{A} .\; \ottnt{e} }{}{}{}{\ottcom{fixpoint}}\ottprodnewline
\ottprodline{|}{ \lambda \ottmv{x} \!:\! \ottnt{A} .\; \ottnt{e} \!:\! \ottnt{B} }{}{}{}{\ottcom{abstraction}}\ottprodnewline
\ottprodline{|}{\ottnt{e_{{\mathrm{1}}}} \, \ottnt{e_{{\mathrm{2}}}}}{}{}{}{\ottcom{application}}\ottprodnewline
\ottprodline{|}{ \Lambda \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{e} \!:\! \ottnt{B} }{}{}{}{\ottcom{type abstraction}}\ottprodnewline
\ottprodline{|}{\ottnt{e} \, \ottnt{A}}{}{}{}{\ottcom{type application}}\ottprodnewline
\ottprodline{|}{\ottsym{\{}  \ell  \ottsym{=}  \ottnt{e}  \ottsym{\}}}{}{}{}{\ottcom{record}}\ottprodnewline
\ottprodline{|}{\ottnt{e}  \ottsym{.}  \ell}{}{}{}{\ottcom{projection}}\ottprodnewline
\ottprodline{|}{ \ottnt{e_{{\mathrm{1}}}} \bbcomma \ottnt{e_{{\mathrm{2}}}} }{}{}{}{\ottcom{merging}}\ottprodnewline
\ottprodline{|}{\ottnt{e}  \ottsym{:}  \ottnt{A}}{}{}{}{\ottcom{casting}}\ottprodnewline
\ottprodline{|}{\ottmv{x}  \ottsym{=}  \ottsym{e1;}  \ottnt{e_{{\mathrm{2}}}}}{}{}{}{\ottcom{definition}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottnt{e}  \ottsym{)}} {\textsf{S}}{}{}{}}

\newcommand{\ottval}{
\ottrulehead{\ottnt{val}  ,\ \ottnt{v}}{::=}{\ottcom{values}}\ottprodnewline
\ottfirstprodline{|}{\ottsym{\{\}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{ n }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \lambda \ottmv{x} \!:\! \ottnt{A} .\; \ottnt{e} \!:\! \ottnt{B} }{}{}{}{}\ottprodnewline
\ottprodline{|}{ \Lambda \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{e} \!:\! \ottnt{B} }{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottsym{\{}  \ell  \ottsym{=}  \ottnt{v}  \ottsym{\}}}{}{}{}{}\ottprodnewline
\ottprodline{|}{ \ottnt{v_{{\mathrm{1}}}} \bbcomma \ottnt{v_{{\mathrm{2}}}} }{}{}{}{}}

\newcommand{\ottarg}{
\ottrulehead{\ottnt{arg}}{::=}{\ottcom{arguments}}\ottprodnewline
\ottfirstprodline{|}{\ottnt{v}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ell}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{A}}{}{}{}{}}

\newcommand{\ottctx}{
\ottrulehead{\ottnt{ctx}  ,\ \Gamma}{::=}{\ottcom{typing context}}\ottprodnewline
\ottfirstprodline{|}{ \cdot }{}{}{}{}\ottprodnewline
\ottprodline{|}{\Gamma  \ottsym{,}  \ottmv{x}  \ottsym{:}  \ottnt{A}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Gamma  \ottsym{,}  \ottmv{X}  \ottsym{*}  \ottnt{A}}{}{}{}{}}

\newcommand{\ottmode}{
\ottrulehead{\Leftrightarrow}{::=}{\ottcom{typing mode}}\ottprodnewline
\ottfirstprodline{|}{\Rightarrow}{}{}{}{}\ottprodnewline
\ottprodline{|}{\Leftarrow}{}{}{}{}}

\newcommand{\ottT}{
\ottrulehead{\ottnt{T}  ,\ \ottnt{Ts}}{::=}{\ottcom{Type indices}}\ottprodnewline
\ottfirstprodline{|}{ \mathbb{Z} }{}{}{}{\ottcom{base type}}\ottprodnewline
\ottprodline{|}{ \overrightarrow{ \ottnt{T} } }{}{}{}{\ottcom{function type}}\ottprodnewline
\ottprodline{|}{ \ottnt{T} ^\forall }{}{}{}{\ottcom{universal type}}\ottprodnewline
\ottprodline{|}{\ottsym{\{}  \ell  \ottsym{:}  \ottnt{T}  \ottsym{\}}}{}{}{}{\ottcom{record type}}\ottprodnewline
\ottprodline{|}{\ottnt{T_{{\mathrm{1}}}}  \, \& \,  \ottnt{T_{{\mathrm{2}}}}}{}{}{}{\ottcom{intersection type}}\ottprodnewline
\ottprodline{|}{\ottsym{(}  \ottnt{A}  \ottsym{)}} {\textsf{S}}{}{}{}}

\newcommand{\ottJ}{
\ottrulehead{\ottnt{J}  ,\ \mathtt{code}}{::=}{\ottcom{JavaScript statements}}\ottprodnewline
\ottfirstprodline{|}{ \varnothing }{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{J_{{\mathrm{1}}}}  \ottsym{;}  \ottnt{J_{{\mathrm{2}}}}}{}{}{}{}}

\newcommand{\ottp}{
\ottrulehead{\ottnt{p}}{::=}{\ottcom{parameters}}\ottprodnewline
\ottfirstprodline{|}{\ottmv{x}  \ottsym{:}  \ottnt{A}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottnt{A}}{}{}{}{}}

\newcommand{\ottdst}{
\ottrulehead{\ottnt{dst}}{::=}{\ottcom{destinations}}\ottprodnewline
\ottfirstprodline{|}{\ottkw{nil}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{x}}{}{}{}{}\ottprodnewline
\ottprodline{|}{\ottmv{x}  \ottsym{\mbox{?}}}{}{}{}{}}

\newcommand{\ottpm}{
\ottrulehead{^\pm}{::=}{\ottcom{plus/minus}}\ottprodnewline
\ottfirstprodline{|}{ ^+ }{}{}{}{}\ottprodnewline
\ottprodline{|}{ ^- }{}{}{}{}}

\newcommand{\ottgrammar}{\ottgrammartabular{
\otttyp\ottinterrule
\ottord\ottinterrule
\ottexp\ottinterrule
\ottval\ottinterrule
\ottarg\ottinterrule
\ottctx\ottinterrule
\ottmode\ottinterrule
\ottT\ottinterrule
\ottJ\ottinterrule
\ottp\ottinterrule
\ottdst\ottinterrule
\ottpm\ottafterlastrule
}}

% defnss
% defns Algorithmics
%% defn toplike
\newcommand{\ottdruleTLXXTop}[1]{\ottdrule[#1]{%
}{
 \rceil   \top   \lceil }{%
{\ottdrulename{TL\_Top}}{}%
}}


\newcommand{\ottdruleTLXXAnd}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil  \ottnt{A}  \lceil }%
\ottpremise{ \rceil  \ottnt{B}  \lceil }%
}{
 \rceil  \ottnt{A}  \, \& \,  \ottnt{B}  \lceil }{%
{\ottdrulename{TL\_And}}{}%
}}


\newcommand{\ottdruleTLXXArrow}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil  \ottnt{B}  \lceil }%
}{
 \rceil  \ottnt{A}  \rightarrow  \ottnt{B}  \lceil }{%
{\ottdrulename{TL\_Arrow}}{}%
}}


\newcommand{\ottdruleTLXXAll}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil  \ottnt{B}  \lceil }%
}{
 \rceil   \forall  \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{B}   \lceil }{%
{\ottdrulename{TL\_All}}{}%
}}


\newcommand{\ottdruleTLXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil  \ottnt{A}  \lceil }%
}{
 \rceil  \ottsym{\{}  \ell  \ottsym{:}  \ottnt{A}  \ottsym{\}}  \lceil }{%
{\ottdrulename{TL\_Rcd}}{}%
}}

\newcommand{\ottdefntoplike}[1]{\begin{ottdefnblock}[#1]{$ \rceil  \ottnt{A}  \lceil $}{\ottcom{Top-like types}}
\ottusedrule{\ottdruleTLXXTop{}}
\ottusedrule{\ottdruleTLXXAnd{}}
\ottusedrule{\ottdruleTLXXArrow{}}
\ottusedrule{\ottdruleTLXXAll{}}
\ottusedrule{\ottdruleTLXXRcd{}}
\end{ottdefnblock}}

%% defn spl
\newcommand{\ottdruleSpXXAnd}[1]{\ottdrule[#1]{%
}{
 \ottnt{A}  \lhd\, \ottnt{A}  \, \& \,  \ottnt{B} \,\rhd  \ottnt{B} }{%
{\ottdrulename{Sp\_And}}{}%
}}


\newcommand{\ottdruleSpXXArrow}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{B_{{\mathrm{1}}}}  \lhd\, \ottnt{B} \,\rhd  \ottnt{B_{{\mathrm{2}}}} }%
}{
 \ottnt{A}  \rightarrow  \ottnt{B_{{\mathrm{1}}}}  \lhd\, \ottnt{A}  \rightarrow  \ottnt{B} \,\rhd  \ottnt{A}  \rightarrow  \ottnt{B_{{\mathrm{2}}}} }{%
{\ottdrulename{Sp\_Arrow}}{}%
}}


\newcommand{\ottdruleSpXXAll}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{B_{{\mathrm{1}}}}  \lhd\, \ottnt{B} \,\rhd  \ottnt{B_{{\mathrm{2}}}} }%
}{
  \forall  \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{B_{{\mathrm{1}}}}   \lhd\,  \forall  \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{B}  \,\rhd   \forall  \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{B_{{\mathrm{2}}}}  }{%
{\ottdrulename{Sp\_All}}{}%
}}


\newcommand{\ottdruleSpXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{A_{{\mathrm{1}}}}  \lhd\, \ottnt{A} \,\rhd  \ottnt{A_{{\mathrm{2}}}} }%
}{
 \ottsym{\{}  \ell  \ottsym{:}  \ottnt{A_{{\mathrm{1}}}}  \ottsym{\}}  \lhd\, \ottsym{\{}  \ell  \ottsym{:}  \ottnt{A}  \ottsym{\}} \,\rhd  \ottsym{\{}  \ell  \ottsym{:}  \ottnt{A_{{\mathrm{2}}}}  \ottsym{\}} }{%
{\ottdrulename{Sp\_Rcd}}{}%
}}

\newcommand{\ottdefnspl}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{B}  \lhd\, \ottnt{A} \,\rhd  \ottnt{C} $}{\ottcom{Splittable types}}
\ottusedrule{\ottdruleSpXXAnd{}}
\ottusedrule{\ottdruleSpXXArrow{}}
\ottusedrule{\ottdruleSpXXAll{}}
\ottusedrule{\ottdruleSpXXRcd{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsAlgorithmics}{
\ottdefntoplike{}\ottdefnspl{}}

% defns Subtyping
%% defn sub
\newcommand{\ottdruleSubXXTop}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil  B^\circ  \lceil }%
}{
\ottnt{A}  \ottsym{<:}  B^\circ}{%
{\ottdrulename{Sub\_Top}}{}%
}}


\newcommand{\ottdruleSubXXBot}[1]{\ottdrule[#1]{%
}{
 \bot   \ottsym{<:}  A^\circ}{%
{\ottdrulename{Sub\_Bot}}{}%
}}


\newcommand{\ottdruleSubXXBase}[1]{\ottdrule[#1]{%
}{
 \mathbb{Z}   \ottsym{<:}   \mathbb{Z} }{%
{\ottdrulename{Sub\_Base}}{}%
}}


\newcommand{\ottdruleSubXXArrow}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{B_{{\mathrm{1}}}}  \ottsym{<:}  \ottnt{A_{{\mathrm{1}}}}}%
\ottpremise{\ottnt{A_{{\mathrm{2}}}}  \ottsym{<:}  B^\circ_{{\mathrm{2}}}}%
}{
\ottnt{A_{{\mathrm{1}}}}  \rightarrow  \ottnt{A_{{\mathrm{2}}}}  \ottsym{<:}  \ottnt{B_{{\mathrm{1}}}}  \rightarrow  B^\circ_{{\mathrm{2}}}}{%
{\ottdrulename{Sub\_Arrow}}{}%
}}


\newcommand{\ottdruleSubXXAll}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{B_{{\mathrm{1}}}}  \ottsym{<:}  \ottnt{A_{{\mathrm{1}}}}}%
\ottpremise{\ottnt{A_{{\mathrm{2}}}}  \ottsym{<:}  B^\circ_{{\mathrm{2}}}}%
}{
 \forall  \ottmv{X} \!*\! \ottnt{A_{{\mathrm{1}}}} .\; \ottnt{A_{{\mathrm{2}}}}   \ottsym{<:}   \forall  \ottmv{X} \!*\! \ottnt{B_{{\mathrm{1}}}} .\; B^\circ_{{\mathrm{2}}} }{%
{\ottdrulename{Sub\_All}}{}%
}}


\newcommand{\ottdruleSubXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{A}  \ottsym{<:}  B^\circ}%
}{
\ottsym{\{}  \ell  \ottsym{:}  \ottnt{A}  \ottsym{\}}  \ottsym{<:}  \ottsym{\{}  \ell  \ottsym{:}  B^\circ  \ottsym{\}}}{%
{\ottdrulename{Sub\_Rcd}}{}%
}}


\newcommand{\ottdruleSubXXAndL}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{A}  \ottsym{<:}  C^\circ}%
}{
\ottnt{A}  \, \& \,  \ottnt{B}  \ottsym{<:}  C^\circ}{%
{\ottdrulename{Sub\_AndL}}{}%
}}


\newcommand{\ottdruleSubXXAndR}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{B}  \ottsym{<:}  C^\circ}%
}{
\ottnt{A}  \, \& \,  \ottnt{B}  \ottsym{<:}  C^\circ}{%
{\ottdrulename{Sub\_AndR}}{}%
}}


\newcommand{\ottdruleSubXXSplit}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{B_{{\mathrm{1}}}}  \lhd\, \ottnt{B} \,\rhd  \ottnt{B_{{\mathrm{2}}}} }%
\ottpremise{\ottnt{A}  \ottsym{<:}  \ottnt{B_{{\mathrm{1}}}}}%
\ottpremise{\ottnt{A}  \ottsym{<:}  \ottnt{B_{{\mathrm{2}}}}}%
}{
\ottnt{A}  \ottsym{<:}  \ottnt{B}}{%
{\ottdrulename{Sub\_Split}}{}%
}}

\newcommand{\ottdefnsub}[1]{\begin{ottdefnblock}[#1]{$\ottnt{A}  \ottsym{<:}  \ottnt{B}$}{\ottcom{Subtyping}}
\ottusedrule{\ottdruleSubXXTop{}}
\ottusedrule{\ottdruleSubXXBot{}}
\ottusedrule{\ottdruleSubXXBase{}}
\ottusedrule{\ottdruleSubXXArrow{}}
\ottusedrule{\ottdruleSubXXAll{}}
\ottusedrule{\ottdruleSubXXRcd{}}
\ottusedrule{\ottdruleSubXXAndL{}}
\ottusedrule{\ottdruleSubXXAndR{}}
\ottusedrule{\ottdruleSubXXSplit{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsSubtyping}{
\ottdefnsub{}}

% defns Typing
%% defn appdist
\newcommand{\ottdruleADXXArrow}[1]{\ottdrule[#1]{%
}{
 \ottnt{A}  \rightarrow  \ottnt{B}  \rhd  \ottnt{A}  \rightarrow  \ottnt{B} }{%
{\ottdrulename{AD\_Arrow}}{}%
}}


\newcommand{\ottdruleADXXTopArrow}[1]{\ottdrule[#1]{%
}{
  \top   \rhd   \top   \rightarrow   \top  }{%
{\ottdrulename{AD\_TopArrow}}{}%
}}


\newcommand{\ottdruleADXXAndArrow}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{A}  \rhd  \ottnt{A_{{\mathrm{1}}}}  \rightarrow  \ottnt{A_{{\mathrm{2}}}} }%
\ottpremise{ \ottnt{B}  \rhd  \ottnt{B_{{\mathrm{1}}}}  \rightarrow  \ottnt{B_{{\mathrm{2}}}} }%
}{
 \ottnt{A}  \, \& \,  \ottnt{B}  \rhd  \ottnt{A_{{\mathrm{1}}}}  \, \& \,  \ottnt{B_{{\mathrm{1}}}}  \rightarrow  \ottnt{A_{{\mathrm{2}}}}  \, \& \,  \ottnt{B_{{\mathrm{2}}}} }{%
{\ottdrulename{AD\_AndArrow}}{}%
}}


\newcommand{\ottdruleADXXAll}[1]{\ottdrule[#1]{%
}{
  \forall  \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{B}   \rhd   \forall  \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{B}  }{%
{\ottdrulename{AD\_All}}{}%
}}


\newcommand{\ottdruleADXXTopAll}[1]{\ottdrule[#1]{%
}{
  \top   \rhd   \forall  \ottmv{X} \!*\!  \top  .\;  \top   }{%
{\ottdrulename{AD\_TopAll}}{}%
}}


\newcommand{\ottdruleADXXAndAll}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{A}  \rhd   \forall  \ottmv{X} \!*\! \ottnt{A_{{\mathrm{1}}}} .\; \ottnt{A_{{\mathrm{2}}}}  }%
\ottpremise{ \ottnt{B}  \rhd   \forall  \ottmv{X} \!*\! \ottnt{B_{{\mathrm{1}}}} .\; \ottnt{B_{{\mathrm{2}}}}  }%
}{
 \ottnt{A}  \, \& \,  \ottnt{B}  \rhd  \forall \, \ottmv{X}  \ottsym{*}  \ottnt{A_{{\mathrm{1}}}}  \, \& \,  \ottnt{B_{{\mathrm{1}}}}  \ottsym{.}  \ottnt{A_{{\mathrm{2}}}}  \, \& \,  \ottnt{B_{{\mathrm{2}}}} }{%
{\ottdrulename{AD\_AndAll}}{}%
}}


\newcommand{\ottdruleADXXRcd}[1]{\ottdrule[#1]{%
}{
 \ottsym{\{}  \ell  \ottsym{:}  \ottnt{A}  \ottsym{\}}  \rhd  \ottsym{\{}  \ell  \ottsym{:}  \ottnt{A}  \ottsym{\}} }{%
{\ottdrulename{AD\_Rcd}}{}%
}}


\newcommand{\ottdruleADXXTopRcd}[1]{\ottdrule[#1]{%
}{
  \top   \rhd  \ottsym{\{}  \ell  \ottsym{:}   \top   \ottsym{\}} }{%
{\ottdrulename{AD\_TopRcd}}{}%
}}


\newcommand{\ottdruleADXXAndRcd}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{A}  \rhd  \ottsym{\{}  \ell  \ottsym{:}  \ottnt{A'}  \ottsym{\}} }%
\ottpremise{ \ottnt{B}  \rhd  \ottsym{\{}  \ell  \ottsym{:}  \ottnt{B'}  \ottsym{\}} }%
}{
 \ottnt{A}  \, \& \,  \ottnt{B}  \rhd  \ottsym{\{}  \ell  \ottsym{:}  \ottnt{A'}  \, \& \,  \ottnt{B'}  \ottsym{\}} }{%
{\ottdrulename{AD\_AndRcd}}{}%
}}

\newcommand{\ottdefnappdist}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{A}  \rhd  \ottnt{B} $}{\ottcom{Applicative distribution}}
\ottusedrule{\ottdruleADXXArrow{}}
\ottusedrule{\ottdruleADXXTopArrow{}}
\ottusedrule{\ottdruleADXXAndArrow{}}
\ottusedrule{\ottdruleADXXAll{}}
\ottusedrule{\ottdruleADXXTopAll{}}
\ottusedrule{\ottdruleADXXAndAll{}}
\ottusedrule{\ottdruleADXXRcd{}}
\ottusedrule{\ottdruleADXXTopRcd{}}
\ottusedrule{\ottdruleADXXAndRcd{}}
\end{ottdefnblock}}

%% defn typing
\newcommand{\ottdruleTypXXTop}[1]{\ottdrule[#1]{%
\ottpremise{  }%
}{
\Gamma  \vdash  \ottsym{\{\}} \, \Rightarrow \,  \top }{%
{\ottdrulename{Typ\_Top}}{}%
}}


\newcommand{\ottdruleTypXXBase}[1]{\ottdrule[#1]{%
\ottpremise{  }%
}{
\Gamma  \vdash   n  \, \Rightarrow \,  \mathbb{Z} }{%
{\ottdrulename{Typ\_Base}}{}%
}}


\newcommand{\ottdruleTypXXVar}[1]{\ottdrule[#1]{%
\ottpremise{  }%
\ottpremise{\ottmv{x}  \ottsym{:}  \ottnt{A} \, \in \, \Gamma}%
}{
\Gamma  \vdash  \ottmv{x} \, \Rightarrow \, \ottnt{A}}{%
{\ottdrulename{Typ\_Var}}{}%
}}


\newcommand{\ottdruleTypXXFix}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \ottsym{,}  \ottmv{x}  \ottsym{:}  \ottnt{A}  \vdash  \ottnt{e} \, \Leftarrow \, \ottnt{A}}%
}{
\Gamma  \vdash   \ottkw{fix} \, \ottmv{x} \!:\! \ottnt{A} .\; \ottnt{e}  \, \Rightarrow \, \ottnt{A}}{%
{\ottdrulename{Typ\_Fix}}{}%
}}


\newcommand{\ottdruleTypXXAbs}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \ottsym{,}  \ottmv{x}  \ottsym{:}  \ottnt{A}  \vdash  \ottnt{e} \, \Leftarrow \, \ottnt{B}}%
}{
\Gamma  \vdash   \lambda \ottmv{x} \!:\! \ottnt{A} .\; \ottnt{e} \!:\! \ottnt{B}  \, \Rightarrow \, \ottnt{A}  \rightarrow  \ottnt{B}}{%
{\ottdrulename{Typ\_Abs}}{}%
}}


\newcommand{\ottdruleTypXXApp}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e_{{\mathrm{1}}}} \, \Rightarrow \, \ottnt{A}}%
\ottpremise{ \ottnt{A}  \rhd  \ottnt{B}  \rightarrow  \ottnt{C} }%
\ottpremise{\Gamma  \vdash  \ottnt{e_{{\mathrm{2}}}} \, \Leftarrow \, \ottnt{B}}%
}{
\Gamma  \vdash  \ottnt{e_{{\mathrm{1}}}} \, \ottnt{e_{{\mathrm{2}}}} \, \Rightarrow \, \ottnt{C}}{%
{\ottdrulename{Typ\_App}}{}%
}}


\newcommand{\ottdruleTypXXTAbs}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \ottsym{,}  \ottmv{X}  \ottsym{*}  \ottnt{A}  \vdash  \ottnt{e} \, \Leftarrow \, \ottnt{B}}%
}{
\Gamma  \vdash   \Lambda \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{e} \!:\! \ottnt{B}  \, \Rightarrow \,  \forall  \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{B} }{%
{\ottdrulename{Typ\_TAbs}}{}%
}}


\newcommand{\ottdruleTypXXTApp}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, \Rightarrow \, \ottnt{B}}%
\ottpremise{ \ottnt{B}  \rhd   \forall  \ottmv{X} \!*\! \ottnt{C_{{\mathrm{1}}}} .\; \ottnt{C_{{\mathrm{2}}}}  }%
\ottpremise{\Gamma  \vdash  \ottnt{A}  \ottsym{*}  \ottnt{C_{{\mathrm{1}}}}}%
}{
\Gamma  \vdash  \ottnt{e} \, \ottnt{A} \, \Rightarrow \, \ottnt{C_{{\mathrm{2}}}}  \ottsym{[}  \ottmv{X}  \mapsto  \ottnt{A}  \ottsym{]}}{%
{\ottdrulename{Typ\_TApp}}{}%
}}


\newcommand{\ottdruleTypXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, \Rightarrow \, \ottnt{A}}%
}{
\Gamma  \vdash  \ottsym{\{}  \ell  \ottsym{=}  \ottnt{e}  \ottsym{\}} \, \Rightarrow \, \ottsym{\{}  \ell  \ottsym{:}  \ottnt{A}  \ottsym{\}}}{%
{\ottdrulename{Typ\_Rcd}}{}%
}}


\newcommand{\ottdruleTypXXProj}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, \Rightarrow \, \ottnt{A}}%
\ottpremise{ \ottnt{A}  \rhd  \ottsym{\{}  \ell  \ottsym{:}  \ottnt{B}  \ottsym{\}} }%
}{
\Gamma  \vdash  \ottnt{e}  \ottsym{.}  \ell \, \Rightarrow \, \ottnt{B}}{%
{\ottdrulename{Typ\_Proj}}{}%
}}


\newcommand{\ottdruleTypXXMerge}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e_{{\mathrm{1}}}} \, \Rightarrow \, \ottnt{A}}%
\ottpremise{\Gamma  \vdash  \ottnt{e_{{\mathrm{2}}}} \, \Rightarrow \, \ottnt{B}}%
\ottpremise{\Gamma  \vdash  \ottnt{A}  \ottsym{*}  \ottnt{B}}%
}{
\Gamma  \vdash   \ottnt{e_{{\mathrm{1}}}} \bbcomma \ottnt{e_{{\mathrm{2}}}}  \, \Rightarrow \, \ottnt{A}  \, \& \,  \ottnt{B}}{%
{\ottdrulename{Typ\_Merge}}{}%
}}


\newcommand{\ottdruleTypXXMergeV}[1]{\ottdrule[#1]{%
\ottpremise{  }%
\ottpremise{ \cdot   \vdash  \ottnt{v_{{\mathrm{1}}}} \, \Rightarrow \, \ottnt{A}}%
\ottpremise{ \cdot   \vdash  \ottnt{v_{{\mathrm{2}}}} \, \Rightarrow \, \ottnt{B}}%
\ottpremise{\ottnt{v_{{\mathrm{1}}}}  \approx  \ottnt{v_{{\mathrm{2}}}}}%
}{
\Gamma  \vdash   \ottnt{v_{{\mathrm{1}}}} \bbcomma \ottnt{v_{{\mathrm{2}}}}  \, \Rightarrow \, \ottnt{A}  \, \& \,  \ottnt{B}}{%
{\ottdrulename{Typ\_MergeV}}{}%
}}


\newcommand{\ottdruleTypXXAnno}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, \Leftarrow \, \ottnt{A}}%
}{
\Gamma  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{A} \, \Rightarrow \, \ottnt{A}}{%
{\ottdrulename{Typ\_Anno}}{}%
}}


\newcommand{\ottdruleTypXXSub}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, \Rightarrow \, \ottnt{A}}%
\ottpremise{\ottnt{A}  \ottsym{<:}  \ottnt{B}}%
}{
\Gamma  \vdash  \ottnt{e} \, \Leftarrow \, \ottnt{B}}{%
{\ottdrulename{Typ\_Sub}}{}%
}}

\newcommand{\ottdefntyping}[1]{\begin{ottdefnblock}[#1]{$\Gamma  \vdash  \ottnt{e} \, \Leftrightarrow \, \ottnt{A}$}{\ottcom{Bidirectional typing}}
\ottusedrule{\ottdruleTypXXTop{}}
\ottusedrule{\ottdruleTypXXBase{}}
\ottusedrule{\ottdruleTypXXVar{}}
\ottusedrule{\ottdruleTypXXFix{}}
\ottusedrule{\ottdruleTypXXAbs{}}
\ottusedrule{\ottdruleTypXXApp{}}
\ottusedrule{\ottdruleTypXXTAbs{}}
\ottusedrule{\ottdruleTypXXTApp{}}
\ottusedrule{\ottdruleTypXXRcd{}}
\ottusedrule{\ottdruleTypXXProj{}}
\ottusedrule{\ottdruleTypXXMerge{}}
\ottusedrule{\ottdruleTypXXMergeV{}}
\ottusedrule{\ottdruleTypXXAnno{}}
\ottusedrule{\ottdruleTypXXSub{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsTyping}{
\ottdefnappdist{}\ottdefntyping{}}

% defns Semantics
%% defn casting
\newcommand{\ottdruleCastXXTop}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil  A^\circ  \lceil }%
}{
 \ottnt{v} \; \hookrightarrow _{ A^\circ }\; \ottsym{\{\}} }{%
{\ottdrulename{Cast\_Top}}{}%
}}


\newcommand{\ottdruleCastXXBase}[1]{\ottdrule[#1]{%
}{
  n  \; \hookrightarrow _{  \mathbb{Z}  }\;  n  }{%
{\ottdrulename{Cast\_Base}}{}%
}}


\newcommand{\ottdruleCastXXArrow}[1]{\ottdrule[#1]{%
\ottpremise{ \neg   \rceil  B^\circ_{{\mathrm{2}}}  \lceil  }%
\ottpremise{\ottnt{B_{{\mathrm{1}}}}  \ottsym{<:}  \ottnt{A_{{\mathrm{1}}}}}%
\ottpremise{\ottnt{A_{{\mathrm{2}}}}  \ottsym{<:}  B^\circ_{{\mathrm{2}}}}%
}{
  \lambda \ottmv{x} \!:\! \ottnt{A_{{\mathrm{1}}}} .\; \ottnt{e} \!:\! \ottnt{A_{{\mathrm{2}}}}  \; \hookrightarrow _{ \ottnt{B_{{\mathrm{1}}}}  \rightarrow  B^\circ_{{\mathrm{2}}} }\;  \lambda \ottmv{x} \!:\! \ottnt{A_{{\mathrm{1}}}} .\; \ottnt{e} \!:\! B^\circ_{{\mathrm{2}}}  }{%
{\ottdrulename{Cast\_Arrow}}{}%
}}


\newcommand{\ottdruleCastXXAll}[1]{\ottdrule[#1]{%
\ottpremise{ \neg   \rceil  B^\circ_{{\mathrm{2}}}  \lceil  }%
\ottpremise{\ottnt{B_{{\mathrm{1}}}}  \ottsym{<:}  \ottnt{A_{{\mathrm{1}}}}}%
\ottpremise{\ottnt{A_{{\mathrm{2}}}}  \ottsym{<:}  B^\circ_{{\mathrm{2}}}}%
}{
  \Lambda \ottmv{X} \!*\! \ottnt{A_{{\mathrm{1}}}} .\; \ottnt{e} \!:\! \ottnt{A_{{\mathrm{2}}}}  \; \hookrightarrow _{ \forall \, \ottmv{X}  \ottsym{*}  \ottnt{B_{{\mathrm{1}}}}  \ottsym{.}  B^\circ_{{\mathrm{2}}} }\;  \Lambda \ottmv{X} \!*\! \ottnt{A_{{\mathrm{1}}}} .\; \ottnt{e} \!:\! B^\circ_{{\mathrm{2}}}  }{%
{\ottdrulename{Cast\_All}}{}%
}}


\newcommand{\ottdruleCastXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{ \neg   \rceil  A^\circ  \lceil  }%
\ottpremise{ \ottnt{v} \; \hookrightarrow _{ A^\circ }\; \ottnt{v'} }%
}{
 \ottsym{\{}  \ell  \ottsym{=}  \ottnt{v}  \ottsym{\}} \; \hookrightarrow _{ \ottsym{\{}  \ell  \ottsym{:}  A^\circ  \ottsym{\}} }\; \ottsym{\{}  \ell  \ottsym{=}  \ottnt{v'}  \ottsym{\}} }{%
{\ottdrulename{Cast\_Rcd}}{}%
}}


\newcommand{\ottdruleCastXXMergeL}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{v_{{\mathrm{1}}}} \; \hookrightarrow _{ A^\circ }\; \ottnt{v'_{{\mathrm{1}}}} }%
}{
  \ottnt{v_{{\mathrm{1}}}} \bbcomma \ottnt{v_{{\mathrm{2}}}}  \; \hookrightarrow _{ A^\circ }\; \ottnt{v'_{{\mathrm{1}}}} }{%
{\ottdrulename{Cast\_MergeL}}{}%
}}


\newcommand{\ottdruleCastXXMergeR}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{v_{{\mathrm{2}}}} \; \hookrightarrow _{ A^\circ }\; \ottnt{v'_{{\mathrm{2}}}} }%
}{
  \ottnt{v_{{\mathrm{1}}}} \bbcomma \ottnt{v_{{\mathrm{2}}}}  \; \hookrightarrow _{ A^\circ }\; \ottnt{v'_{{\mathrm{2}}}} }{%
{\ottdrulename{Cast\_MergeR}}{}%
}}


\newcommand{\ottdruleCastXXSplit}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{A_{{\mathrm{1}}}}  \lhd\, \ottnt{A} \,\rhd  \ottnt{A_{{\mathrm{2}}}} }%
\ottpremise{ \ottnt{v} \; \hookrightarrow _{ \ottnt{A_{{\mathrm{1}}}} }\; \ottnt{v_{{\mathrm{1}}}} }%
\ottpremise{ \ottnt{v} \; \hookrightarrow _{ \ottnt{A_{{\mathrm{2}}}} }\; \ottnt{v_{{\mathrm{2}}}} }%
}{
 \ottnt{v} \; \hookrightarrow _{ \ottnt{A} }\;  \ottnt{v_{{\mathrm{1}}}} \bbcomma \ottnt{v_{{\mathrm{2}}}}  }{%
{\ottdrulename{Cast\_Split}}{}%
}}

\newcommand{\ottdefncasting}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{v} \; \hookrightarrow _{ \ottnt{A} }\; \ottnt{v'} $}{\ottcom{Type casting}}
\ottusedrule{\ottdruleCastXXTop{}}
\ottusedrule{\ottdruleCastXXBase{}}
\ottusedrule{\ottdruleCastXXArrow{}}
\ottusedrule{\ottdruleCastXXAll{}}
\ottusedrule{\ottdruleCastXXRcd{}}
\ottusedrule{\ottdruleCastXXMergeL{}}
\ottusedrule{\ottdruleCastXXMergeR{}}
\ottusedrule{\ottdruleCastXXSplit{}}
\end{ottdefnblock}}

%% defn papp
\newcommand{\ottdrulePAppXXTop}[1]{\ottdrule[#1]{%
}{
 \ottsym{\{\}} \,\bullet\, \ottnt{arg} \; \hookrightarrow \; \ottsym{\{\}} }{%
{\ottdrulename{PApp\_Top}}{}%
}}


\newcommand{\ottdrulePAppXXAbs}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{v} \; \hookrightarrow _{ \ottnt{A} }\; \ottnt{v'} }%
}{
  \lambda \ottmv{x} \!:\! \ottnt{A} .\; \ottnt{e} \!:\! \ottnt{B}  \,\bullet\, \ottnt{v} \; \hookrightarrow \; \ottnt{e}  \ottsym{[}  \ottmv{x}  \mapsto  \ottnt{v'}  \ottsym{]}  \ottsym{:}  \ottnt{B} }{%
{\ottdrulename{PApp\_Abs}}{}%
}}


\newcommand{\ottdrulePAppXXTAbs}[1]{\ottdrule[#1]{%
}{
  \Lambda \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{e} \!:\! \ottnt{B}  \,\bullet\, \ottnt{C} \; \hookrightarrow \; \ottnt{e}  \ottsym{[}  \ottmv{X}  \mapsto  \ottnt{C}  \ottsym{]}  \ottsym{:}  \ottnt{B}  \ottsym{[}  \ottmv{X}  \mapsto  \ottnt{C}  \ottsym{]} }{%
{\ottdrulename{PApp\_TAbs}}{}%
}}


\newcommand{\ottdrulePAppXXRcd}[1]{\ottdrule[#1]{%
}{
 \ottsym{\{}  \ell  \ottsym{=}  \ottnt{v}  \ottsym{\}} \,\bullet\, \ell \; \hookrightarrow \; \ottnt{v} }{%
{\ottdrulename{PApp\_Rcd}}{}%
}}


\newcommand{\ottdrulePAppXXMerge}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{v_{{\mathrm{1}}}} \,\bullet\, \ottnt{arg} \; \hookrightarrow \; \ottnt{e_{{\mathrm{1}}}} }%
\ottpremise{ \ottnt{v_{{\mathrm{2}}}} \,\bullet\, \ottnt{arg} \; \hookrightarrow \; \ottnt{e_{{\mathrm{2}}}} }%
}{
  \ottnt{v_{{\mathrm{1}}}} \bbcomma \ottnt{v_{{\mathrm{2}}}}  \,\bullet\, \ottnt{arg} \; \hookrightarrow \;  \ottnt{e_{{\mathrm{1}}}} \bbcomma \ottnt{e_{{\mathrm{2}}}}  }{%
{\ottdrulename{PApp\_Merge}}{}%
}}

\newcommand{\ottdefnpapp}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{v} \,\bullet\, \ottnt{arg} \; \hookrightarrow \; \ottnt{e} $}{\ottcom{Parallel application}}
\ottusedrule{\ottdrulePAppXXTop{}}
\ottusedrule{\ottdrulePAppXXAbs{}}
\ottusedrule{\ottdrulePAppXXTAbs{}}
\ottusedrule{\ottdrulePAppXXRcd{}}
\ottusedrule{\ottdrulePAppXXMerge{}}
\end{ottdefnblock}}

%% defn step
\newcommand{\ottdruleStepXXFix}[1]{\ottdrule[#1]{%
}{
  \ottkw{fix} \, \ottmv{x} \!:\! \ottnt{A} .\; \ottnt{e}  \; \hookrightarrow \; \ottnt{e}  \ottsym{[}  \ottmv{x}  \mapsto   \ottkw{fix} \, \ottmv{x} \!:\! \ottnt{A} .\; \ottnt{e}   \ottsym{]}  \ottsym{:}  \ottnt{A} }{%
{\ottdrulename{Step\_Fix}}{}%
}}


\newcommand{\ottdruleStepXXPApp}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{v_{{\mathrm{1}}}} \,\bullet\, \ottnt{v_{{\mathrm{2}}}} \; \hookrightarrow \; \ottnt{e} }%
}{
 \ottnt{v_{{\mathrm{1}}}} \, \ottnt{v_{{\mathrm{2}}}} \; \hookrightarrow \; \ottnt{e} }{%
{\ottdrulename{Step\_PApp}}{}%
}}


\newcommand{\ottdruleStepXXPTApp}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{v} \,\bullet\, \ottnt{A} \; \hookrightarrow \; \ottnt{e} }%
}{
 \ottnt{v} \, \ottnt{A} \; \hookrightarrow \; \ottnt{e} }{%
{\ottdrulename{Step\_PTApp}}{}%
}}


\newcommand{\ottdruleStepXXPProj}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{v} \,\bullet\, \ell \; \hookrightarrow \; \ottnt{e} }%
}{
 \ottnt{v}  \ottsym{.}  \ell \; \hookrightarrow \; \ottnt{e} }{%
{\ottdrulename{Step\_PProj}}{}%
}}


\newcommand{\ottdruleStepXXCast}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{v} \; \hookrightarrow _{ \ottnt{A} }\; \ottnt{v'} }%
}{
 \ottnt{v}  \ottsym{:}  \ottnt{A} \; \hookrightarrow \; \ottnt{v'} }{%
{\ottdrulename{Step\_Cast}}{}%
}}


\newcommand{\ottdruleStepXXAppL}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{e_{{\mathrm{1}}}} \; \hookrightarrow \; \ottnt{e'_{{\mathrm{1}}}} }%
}{
 \ottnt{e_{{\mathrm{1}}}} \, \ottnt{e_{{\mathrm{2}}}} \; \hookrightarrow \; \ottnt{e'_{{\mathrm{1}}}} \, \ottnt{e_{{\mathrm{2}}}} }{%
{\ottdrulename{Step\_AppL}}{}%
}}


\newcommand{\ottdruleStepXXAppR}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{e_{{\mathrm{2}}}} \; \hookrightarrow \; \ottnt{e'_{{\mathrm{2}}}} }%
}{
 \ottnt{v_{{\mathrm{1}}}} \, \ottnt{e_{{\mathrm{2}}}} \; \hookrightarrow \; \ottnt{v_{{\mathrm{1}}}} \, \ottnt{e'_{{\mathrm{2}}}} }{%
{\ottdrulename{Step\_AppR}}{}%
}}


\newcommand{\ottdruleStepXXTApp}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{e} \; \hookrightarrow \; \ottnt{e'} }%
}{
 \ottnt{e} \, \ottnt{A} \; \hookrightarrow \; \ottnt{e'} \, \ottnt{A} }{%
{\ottdrulename{Step\_TApp}}{}%
}}


\newcommand{\ottdruleStepXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{e} \; \hookrightarrow \; \ottnt{e'} }%
}{
 \ottsym{\{}  \ell  \ottsym{=}  \ottnt{e}  \ottsym{\}} \; \hookrightarrow \; \ottsym{\{}  \ell  \ottsym{=}  \ottnt{e'}  \ottsym{\}} }{%
{\ottdrulename{Step\_Rcd}}{}%
}}


\newcommand{\ottdruleStepXXProj}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{e} \; \hookrightarrow \; \ottnt{e'} }%
}{
 \ottnt{e}  \ottsym{.}  \ell \; \hookrightarrow \; \ottnt{e'}  \ottsym{.}  \ell }{%
{\ottdrulename{Step\_Proj}}{}%
}}


\newcommand{\ottdruleStepXXMerge}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{e_{{\mathrm{1}}}} \; \hookrightarrow \; \ottnt{e'_{{\mathrm{1}}}} }%
\ottpremise{ \ottnt{e_{{\mathrm{2}}}} \; \hookrightarrow \; \ottnt{e'_{{\mathrm{2}}}} }%
}{
  \ottnt{e_{{\mathrm{1}}}} \bbcomma \ottnt{e_{{\mathrm{2}}}}  \; \hookrightarrow \;  \ottnt{e'_{{\mathrm{1}}}} \bbcomma \ottnt{e'_{{\mathrm{2}}}}  }{%
{\ottdrulename{Step\_Merge}}{}%
}}


\newcommand{\ottdruleStepXXMergeL}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{e_{{\mathrm{1}}}} \; \hookrightarrow \; \ottnt{e'_{{\mathrm{1}}}} }%
}{
  \ottnt{e_{{\mathrm{1}}}} \bbcomma \ottnt{e_{{\mathrm{2}}}}  \; \hookrightarrow \;  \ottnt{e'_{{\mathrm{1}}}} \bbcomma \ottnt{e_{{\mathrm{2}}}}  }{%
{\ottdrulename{Step\_MergeL}}{}%
}}


\newcommand{\ottdruleStepXXMergeR}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{e_{{\mathrm{2}}}} \; \hookrightarrow \; \ottnt{e'_{{\mathrm{2}}}} }%
}{
  \ottnt{v_{{\mathrm{1}}}} \bbcomma \ottnt{e_{{\mathrm{2}}}}  \; \hookrightarrow \;  \ottnt{v_{{\mathrm{1}}}} \bbcomma \ottnt{e'_{{\mathrm{2}}}}  }{%
{\ottdrulename{Step\_MergeR}}{}%
}}


\newcommand{\ottdruleStepXXAnno}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{e} \; \hookrightarrow \; \ottnt{e'} }%
}{
 \ottnt{e}  \ottsym{:}  \ottnt{A} \; \hookrightarrow \; \ottnt{e'}  \ottsym{:}  \ottnt{A} }{%
{\ottdrulename{Step\_Anno}}{}%
}}

\newcommand{\ottdefnstep}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{e} \; \hookrightarrow \; \ottnt{e'} $}{\ottcom{Small-step operational semantics}}
\ottusedrule{\ottdruleStepXXFix{}}
\ottusedrule{\ottdruleStepXXPApp{}}
\ottusedrule{\ottdruleStepXXPTApp{}}
\ottusedrule{\ottdruleStepXXPProj{}}
\ottusedrule{\ottdruleStepXXCast{}}
\ottusedrule{\ottdruleStepXXAppL{}}
\ottusedrule{\ottdruleStepXXAppR{}}
\ottusedrule{\ottdruleStepXXTApp{}}
\ottusedrule{\ottdruleStepXXRcd{}}
\ottusedrule{\ottdruleStepXXProj{}}
\ottusedrule{\ottdruleStepXXMerge{}}
\ottusedrule{\ottdruleStepXXMergeL{}}
\ottusedrule{\ottdruleStepXXMergeR{}}
\ottusedrule{\ottdruleStepXXAnno{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsSemantics}{
\ottdefncasting{}\ottdefnpapp{}\ottdefnstep{}}

% defns Compilation
%% defn compile
\newcommand{\ottdruleJXXNil}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \ottsym{;}  \ottmv{z}  \vdash  \ottnt{e} \, \Leftrightarrow \, \ottnt{A}  \, \rightsquigarrow \,  \ottnt{J}  \; | \;  \ottmv{z}}%
}{
\Gamma  \ottsym{;}  \ottkw{nil}  \vdash  \ottnt{e} \, \Leftrightarrow \, \ottnt{A}  \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_Nil}}{}%
}}


\newcommand{\ottdruleJXXOpt}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \ottsym{;}  \ottmv{z}  \vdash  \ottnt{e} \, \Leftrightarrow \, \ottnt{A}  \, \rightsquigarrow \,  \ottnt{J}  \; | \;  \ottmv{z}}%
}{
\Gamma  \ottsym{;}  \ottmv{y}  \ottsym{\mbox{?}}  \vdash  \ottnt{e} \, \Leftrightarrow \, \ottnt{A}  \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_Opt}}{}%
}}


\newcommand{\ottdruleJXXTop}[1]{\ottdrule[#1]{%
}{
\Gamma  \ottsym{;}  \ottmv{z}  \vdash  \ottsym{\{\}} \, \Rightarrow \,  \top   \, \rightsquigarrow \,   \varnothing   \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_Top}}{}%
}}


\newcommand{\ottdruleJXXInt}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{T}  \ottsym{=}   |  \mathbb{Z}  | }%
}{
\Gamma  \ottsym{;}  \ottmv{z}  \vdash   n  \, \Rightarrow \,  \mathbb{Z}   \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_Int}}{}%
}}


\newcommand{\ottdruleJXXIntOpt}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{T}  \ottsym{=}   |  \mathbb{Z}  | }%
}{
\Gamma  \ottsym{;}  \ottmv{y}  \ottsym{\mbox{?}}  \vdash   n  \, \Rightarrow \,  \mathbb{Z}   \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_IntOpt}}{}%
}}


\newcommand{\ottdruleJXXIntNil}[1]{\ottdrule[#1]{%
}{
\Gamma  \ottsym{;}  \ottkw{nil}  \vdash   n  \, \Rightarrow \,  \mathbb{Z}   \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_IntNil}}{}%
}}


\newcommand{\ottdruleJXXVar}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{x}  \ottsym{:}  \ottnt{A} \, \in \, \Gamma}%
}{
\Gamma  \ottsym{;}  \ottmv{z}  \vdash  \ottmv{x} \, \Rightarrow \, \ottnt{A}  \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_Var}}{}%
}}


\newcommand{\ottdruleJXXVarOpt}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{x}  \ottsym{:}  \ottnt{A} \, \in \, \Gamma}%
}{
\Gamma  \ottsym{;}  \ottmv{y}  \ottsym{\mbox{?}}  \vdash  \ottmv{x} \, \Rightarrow \, \ottnt{A}  \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{x}}{%
{\ottdrulename{J\_VarOpt}}{}%
}}


\newcommand{\ottdruleJXXVarNil}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{x}  \ottsym{:}  \ottnt{A} \, \in \, \Gamma}%
}{
\Gamma  \ottsym{;}  \ottkw{nil}  \vdash  \ottmv{x} \, \Rightarrow \, \ottnt{A}  \, \rightsquigarrow \,   \varnothing   \; | \;  \ottmv{x}}{%
{\ottdrulename{J\_VarNil}}{}%
}}


\newcommand{\ottdruleJXXFix}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \ottsym{,}  \ottmv{x}  \ottsym{:}  \ottnt{A}  \ottsym{;}  \ottmv{z}  \vdash  \ottnt{e} \, \Leftarrow \, \ottnt{A}  \, \rightsquigarrow \,  \ottnt{J}  \; | \;  \ottmv{z}}%
}{
\Gamma  \ottsym{;}  \ottmv{z}  \vdash   \ottkw{fix} \, \ottmv{x} \!:\! \ottnt{A} .\; \ottnt{e}  \, \Rightarrow \, \ottnt{A}  \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_Fix}}{}%
}}


\newcommand{\ottdruleJXXTopAbs}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil  \ottnt{B}  \lceil }%
}{
\Gamma  \ottsym{;}  \ottmv{z}  \vdash   \lambda \ottmv{x} \!:\! \ottnt{A} .\; \ottnt{e} \!:\! \ottnt{B}  \, \Rightarrow \, \ottnt{A}  \rightarrow  \ottnt{B}  \, \rightsquigarrow \,   \varnothing   \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_TopAbs}}{}%
}}


\newcommand{\ottdruleJXXAbs}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{T}  \ottsym{=}   \overrightarrow{  | \ottnt{B} |  } }%
\ottpremise{\Gamma  \ottsym{,}  \ottmv{x}  \ottsym{:}  \ottnt{A}  \ottsym{;}  \ottmv{y}  \ottsym{\mbox{?}}  \vdash  \ottnt{e} \, \Leftarrow \, \ottnt{B}  \, \rightsquigarrow \,  \ottnt{J}  \; | \;  \ottmv{y_{{\mathrm{0}}}}}%
}{
\Gamma  \ottsym{;}  \ottmv{z}  \vdash   \lambda \ottmv{x} \!:\! \ottnt{A} .\; \ottnt{e} \!:\! \ottnt{B}  \, \Rightarrow \, \ottnt{A}  \rightarrow  \ottnt{B}  \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_Abs}}{}%
}}


\newcommand{\ottdruleJXXApp}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \ottsym{;}  \ottkw{nil}  \vdash  \ottnt{e_{{\mathrm{1}}}} \, \Rightarrow \, \ottnt{A}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{1}}}}  \; | \;  \ottmv{x}}%
\ottpremise{\Gamma  \ottsym{;}  \ottkw{nil}  \vdash  \ottnt{e_{{\mathrm{2}}}} \, \Rightarrow \, \ottnt{B}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{2}}}}  \; | \;  \ottmv{y}}%
\ottpremise{\Gamma  \ottsym{;}  \ottnt{dst}  \vdash  \ottmv{x}  \ottsym{:}  \ottnt{A}  \, \bullet \,  \ottmv{y}  \ottsym{:}  \ottnt{B}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{3}}}}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{C}}%
}{
\Gamma  \ottsym{;}  \ottnt{dst}  \vdash  \ottnt{e_{{\mathrm{1}}}} \, \ottnt{e_{{\mathrm{2}}}} \, \Rightarrow \, \ottnt{C}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{1}}}}  \ottsym{;}  \ottnt{J_{{\mathrm{2}}}}  \ottsym{;}  \ottnt{J_{{\mathrm{3}}}}  \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_App}}{}%
}}


\newcommand{\ottdruleJXXTopTAbs}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil  \ottnt{B}  \lceil }%
}{
\Gamma  \ottsym{;}  \ottmv{z}  \vdash   \Lambda \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{e} \!:\! \ottnt{B}  \, \Rightarrow \,  \forall  \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{B}   \, \rightsquigarrow \,   \varnothing   \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_TopTAbs}}{}%
}}


\newcommand{\ottdruleJXXTAbs}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{T}  \ottsym{=}    | \ottnt{B} |  ^\forall }%
\ottpremise{\Gamma  \ottsym{,}  \ottmv{X}  \ottsym{*}  \ottnt{A}  \ottsym{;}  \ottmv{y}  \ottsym{\mbox{?}}  \vdash  \ottnt{e} \, \Leftarrow \, \ottnt{B}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{2}}}}  \; | \;  \ottmv{y_{{\mathrm{0}}}}}%
}{
\Gamma  \ottsym{;}  \ottmv{z}  \vdash   \Lambda \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{e} \!:\! \ottnt{B}  \, \Rightarrow \,  \forall  \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{B}   \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_TAbs}}{}%
}}


\newcommand{\ottdruleJXXTApp}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \ottsym{;}  \ottkw{nil}  \vdash  \ottnt{e} \, \Rightarrow \, \ottnt{B}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{1}}}}  \; | \;  \ottmv{y}}%
\ottpremise{\Gamma  \ottsym{;}  \ottnt{dst}  \vdash  \ottmv{y}  \ottsym{:}  \ottnt{B}  \, \bullet \,  \ottnt{A}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{2}}}}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{C}}%
}{
\Gamma  \ottsym{;}  \ottnt{dst}  \vdash  \ottnt{e} \, \ottnt{A} \, \Rightarrow \, \ottnt{C}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{1}}}}  \ottsym{;}  \ottnt{J_{{\mathrm{2}}}}  \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_TApp}}{}%
}}


\newcommand{\ottdruleJXXTopRcd}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{e} \, \Rightarrow \, \ottnt{A}}%
\ottpremise{ \rceil  \ottnt{A}  \lceil }%
}{
\Gamma  \ottsym{;}  \ottmv{z}  \vdash  \ottsym{\{}  \ell  \ottsym{=}  \ottnt{e}  \ottsym{\}} \, \Rightarrow \, \ottsym{\{}  \ell  \ottsym{:}  \ottnt{A}  \ottsym{\}}  \, \rightsquigarrow \,   \varnothing   \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_TopRcd}}{}%
}}


\newcommand{\ottdruleJXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{T}  \ottsym{=}  \ottsym{\{}  \ell  \ottsym{:}   | \ottnt{A} |   \ottsym{\}}}%
\ottpremise{\Gamma  \ottsym{;}  \ottkw{nil}  \vdash  \ottnt{e} \, \Rightarrow \, \ottnt{A}  \, \rightsquigarrow \,  \ottnt{J}  \; | \;  \ottmv{y}}%
}{
\Gamma  \ottsym{;}  \ottmv{z}  \vdash  \ottsym{\{}  \ell  \ottsym{=}  \ottnt{e}  \ottsym{\}} \, \Rightarrow \, \ottsym{\{}  \ell  \ottsym{:}  \ottnt{A}  \ottsym{\}}  \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_Rcd}}{}%
}}


\newcommand{\ottdruleJXXProj}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \ottsym{;}  \ottkw{nil}  \vdash  \ottnt{e} \, \Rightarrow \, \ottnt{A}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{1}}}}  \; | \;  \ottmv{y}}%
\ottpremise{\ottmv{y}  \ottsym{:}  \ottnt{A}  \, \bullet \,  \ottsym{\{}  \ell  \ottsym{\}}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{2}}}}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{B}}%
}{
\Gamma  \ottsym{;}  \ottmv{z}  \vdash  \ottnt{e}  \ottsym{.}  \ell \, \Rightarrow \, \ottnt{B}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{1}}}}  \ottsym{;}  \ottnt{J_{{\mathrm{2}}}}  \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_Proj}}{}%
}}


\newcommand{\ottdruleJXXMerge}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \ottsym{;}  \ottmv{z}  \vdash  \ottnt{e_{{\mathrm{1}}}} \, \Rightarrow \, \ottnt{A}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{1}}}}  \; | \;  \ottmv{z}}%
\ottpremise{\Gamma  \ottsym{;}  \ottmv{z}  \vdash  \ottnt{e_{{\mathrm{2}}}} \, \Rightarrow \, \ottnt{B}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{2}}}}  \; | \;  \ottmv{z}}%
\ottpremise{\Gamma  \vdash  \ottnt{A}  \ottsym{*}  \ottnt{B}}%
}{
\Gamma  \ottsym{;}  \ottmv{z}  \vdash   \ottnt{e_{{\mathrm{1}}}} \bbcomma \ottnt{e_{{\mathrm{2}}}}  \, \Rightarrow \, \ottnt{A}  \, \& \,  \ottnt{B}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{1}}}}  \ottsym{;}  \ottnt{J_{{\mathrm{2}}}}  \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_Merge}}{}%
}}


\newcommand{\ottdruleJXXAnno}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \ottsym{;}  \ottnt{dst}  \vdash  \ottnt{e} \, \Leftarrow \, \ottnt{A}  \, \rightsquigarrow \,  \ottnt{J}  \; | \;  \ottmv{z}}%
}{
\Gamma  \ottsym{;}  \ottnt{dst}  \vdash  \ottnt{e}  \ottsym{:}  \ottnt{A} \, \Rightarrow \, \ottnt{A}  \, \rightsquigarrow \,  \ottnt{J}  \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_Anno}}{}%
}}


\newcommand{\ottdruleJXXDef}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \ottsym{;}  \ottmv{x}  \vdash  \ottnt{e_{{\mathrm{1}}}} \, \Rightarrow \, \ottnt{A}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{1}}}}  \; | \;  \ottmv{x}}%
\ottpremise{\Gamma  \ottsym{,}  \ottmv{x}  \ottsym{:}  \ottnt{A}  \ottsym{;}  \ottmv{z}  \vdash  \ottnt{e_{{\mathrm{2}}}} \, \Rightarrow \, \ottnt{B}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{2}}}}  \; | \;  \ottmv{z}}%
}{
\Gamma  \ottsym{;}  \ottmv{z}  \vdash  \ottmv{x}  \ottsym{=}  \ottsym{e1;}  \ottnt{e_{{\mathrm{2}}}} \, \Rightarrow \, \ottnt{B}  \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_Def}}{}%
}}


\newcommand{\ottdruleJXXSub}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \ottsym{;}  \ottkw{nil}  \vdash  \ottnt{e} \, \Rightarrow \, \ottnt{A}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{1}}}}  \; | \;  \ottmv{x}}%
\ottpremise{\ottmv{x}  \ottsym{:}  \ottnt{A}  \ottsym{<:}  \ottmv{y}  \ottsym{:}  \ottnt{B}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{2}}}}}%
}{
\Gamma  \ottsym{;}  \ottmv{y}  \vdash  \ottnt{e} \, \Leftarrow \, \ottnt{B}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{1}}}}  \ottsym{;}  \ottnt{J_{{\mathrm{2}}}}  \; | \;  \ottmv{y}}{%
{\ottdrulename{J\_Sub}}{}%
}}


\newcommand{\ottdruleJXXSubEquiv}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{A}  \fallingdotseq  \ottnt{B}}%
\ottpremise{\Gamma  \ottsym{;}  \ottnt{dst}  \vdash  \ottnt{e} \, \Rightarrow \, \ottnt{A}  \, \rightsquigarrow \,  \ottnt{J}  \; | \;  \ottmv{z}}%
}{
\Gamma  \ottsym{;}  \ottnt{dst}  \vdash  \ottnt{e} \, \Leftarrow \, \ottnt{B}  \, \rightsquigarrow \,  \ottnt{J}  \; | \;  \ottmv{z}}{%
{\ottdrulename{J\_SubEquiv}}{}%
}}

\newcommand{\ottdefncompile}[1]{\begin{ottdefnblock}[#1]{$\Gamma  \ottsym{;}  \ottnt{dst}  \vdash  \ottnt{e} \, \Leftrightarrow \, \ottnt{A}  \, \rightsquigarrow \,  \ottnt{J}  \; | \;  \ottmv{z}$}{\ottcom{Type-directed compilation}}
\ottusedrule{\ottdruleJXXNil{}}
\ottusedrule{\ottdruleJXXOpt{}}
\ottusedrule{\ottdruleJXXTop{}}
\ottusedrule{\ottdruleJXXInt{}}
\ottusedrule{\ottdruleJXXIntOpt{}}
\ottusedrule{\ottdruleJXXIntNil{}}
\ottusedrule{\ottdruleJXXVar{}}
\ottusedrule{\ottdruleJXXVarOpt{}}
\ottusedrule{\ottdruleJXXVarNil{}}
\ottusedrule{\ottdruleJXXFix{}}
\ottusedrule{\ottdruleJXXTopAbs{}}
\ottusedrule{\ottdruleJXXAbs{}}
\ottusedrule{\ottdruleJXXApp{}}
\ottusedrule{\ottdruleJXXTopTAbs{}}
\ottusedrule{\ottdruleJXXTAbs{}}
\ottusedrule{\ottdruleJXXTApp{}}
\ottusedrule{\ottdruleJXXTopRcd{}}
\ottusedrule{\ottdruleJXXRcd{}}
\ottusedrule{\ottdruleJXXProj{}}
\ottusedrule{\ottdruleJXXMerge{}}
\ottusedrule{\ottdruleJXXAnno{}}
\ottusedrule{\ottdruleJXXDef{}}
\ottusedrule{\ottdruleJXXSub{}}
\ottusedrule{\ottdruleJXXSubEquiv{}}
\end{ottdefnblock}}

%% defn dapp
\newcommand{\ottdruleJAXXNil}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \ottsym{;}  \ottmv{z}  \vdash  \ottmv{x}  \ottsym{:}  \ottnt{A}  \, \bullet \,  \ottnt{p}  \, \rightsquigarrow \,  \ottnt{J}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{B}}%
}{
\Gamma  \ottsym{;}  \ottkw{nil}  \vdash  \ottmv{x}  \ottsym{:}  \ottnt{A}  \, \bullet \,  \ottnt{p}  \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{B}}{%
{\ottdrulename{JA\_Nil}}{}%
}}


\newcommand{\ottdruleJAXXOpt}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \ottsym{;}  \ottmv{z}  \vdash  \ottmv{x}  \ottsym{:}  \ottnt{A}  \, \bullet \,  \ottnt{p}  \, \rightsquigarrow \,  \ottnt{J}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{B}}%
}{
\Gamma  \ottsym{;}  \ottmv{y}  \ottsym{\mbox{?}}  \vdash  \ottmv{x}  \ottsym{:}  \ottnt{A}  \, \bullet \,  \ottnt{p}  \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{B}}{%
{\ottdrulename{JA\_Opt}}{}%
}}


\newcommand{\ottdruleJAXXTop}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil  \ottnt{A}  \lceil }%
}{
\Gamma  \ottsym{;}  \ottmv{z}  \vdash  \ottmv{x}  \ottsym{:}  \ottnt{A}  \, \bullet \,  \ottnt{p}  \, \rightsquigarrow \,   \varnothing   \; | \;  \ottmv{z}  \ottsym{:}   \top }{%
{\ottdrulename{JA\_Top}}{}%
}}


\newcommand{\ottdruleJAXXArrow}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{T}  \ottsym{=}   \overrightarrow{  | \ottnt{B} |  } }%
\ottpremise{\ottmv{y}  \ottsym{:}  \ottnt{C}  \ottsym{<:}  \ottmv{y_{{\mathrm{0}}}}  \ottsym{:}  \ottnt{A}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{1}}}}}%
\ottpremise{\Gamma  \ottsym{;}  \ottnt{dst}  \vdash  \ottmv{x}  \ottsym{:}  \ottnt{A}  \rightarrow  \ottnt{B}  \, \bullet \,  \ottmv{y_{{\mathrm{0}}}}  \ottsym{:}  \ottnt{A}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{2}}}}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{B}}%
}{
\Gamma  \ottsym{;}  \ottnt{dst}  \vdash  \ottmv{x}  \ottsym{:}  \ottnt{A}  \rightarrow  \ottnt{B}  \, \bullet \,  \ottmv{y}  \ottsym{:}  \ottnt{C}  \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{B}}{%
{\ottdrulename{JA\_Arrow}}{}%
}}


\newcommand{\ottdruleJAXXArrowEquiv}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{A}  \fallingdotseq  \ottnt{C}}%
\ottpremise{\ottnt{T}  \ottsym{=}   \overrightarrow{  | \ottnt{B} |  } }%
}{
\Gamma  \ottsym{;}  \ottmv{z}  \vdash  \ottmv{x}  \ottsym{:}  \ottnt{A}  \rightarrow  \ottnt{B}  \, \bullet \,  \ottmv{y}  \ottsym{:}  \ottnt{C}  \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{B}}{%
{\ottdrulename{JA\_ArrowEquiv}}{}%
}}


\newcommand{\ottdruleJAXXArrowOpt}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{A}  \fallingdotseq  \ottnt{C}}%
\ottpremise{\ottnt{T}  \ottsym{=}   \overrightarrow{  | \ottnt{B} |  } }%
}{
\Gamma  \ottsym{;}  \ottmv{z_{{\mathrm{0}}}}  \ottsym{\mbox{?}}  \vdash  \ottmv{x}  \ottsym{:}  \ottnt{A}  \rightarrow  \ottnt{B}  \, \bullet \,  \ottmv{y}  \ottsym{:}  \ottnt{C}  \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{B}}{%
{\ottdrulename{JA\_ArrowOpt}}{}%
}}


\newcommand{\ottdruleJAXXArrowNil}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{A}  \fallingdotseq  \ottnt{C}}%
\ottpremise{\ottnt{T}  \ottsym{=}   \overrightarrow{  | \ottnt{B} |  } }%
}{
\Gamma  \ottsym{;}  \ottkw{nil}  \vdash  \ottmv{x}  \ottsym{:}  \ottnt{A}  \rightarrow  \ottnt{B}  \, \bullet \,  \ottmv{y}  \ottsym{:}  \ottnt{C}  \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{B}}{%
{\ottdrulename{JA\_ArrowNil}}{}%
}}


\newcommand{\ottdruleJAXXAll}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{A}  \ottsym{*}  \ottnt{C}}%
\ottpremise{\ottnt{T}  \ottsym{=}    | \ottnt{B} |  ^\forall }%
\ottpremise{\ottnt{Ts}  \ottsym{=} \, \ottkw{itoa} \, \; | \;  \ottnt{C}  \; | \;}%
}{
\Gamma  \ottsym{;}  \ottmv{z}  \vdash  \ottmv{x}  \ottsym{:}   \forall  \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{B}   \, \bullet \,  \ottnt{C}  \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{B}  \ottsym{[}  \ottmv{X}  \mapsto  \ottnt{C}  \ottsym{]}}{%
{\ottdrulename{JA\_All}}{}%
}}


\newcommand{\ottdruleJAXXAllOpt}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{A}  \ottsym{*}  \ottnt{C}}%
\ottpremise{\ottnt{T}  \ottsym{=}    | \ottnt{B} |  ^\forall }%
\ottpremise{\ottnt{Ts}  \ottsym{=} \, \ottkw{itoa} \, \; | \;  \ottnt{C}  \; | \;}%
}{
\Gamma  \ottsym{;}  \ottmv{y}  \ottsym{\mbox{?}}  \vdash  \ottmv{x}  \ottsym{:}   \forall  \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{B}   \, \bullet \,  \ottnt{C}  \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{B}  \ottsym{[}  \ottmv{X}  \mapsto  \ottnt{C}  \ottsym{]}}{%
{\ottdrulename{JA\_AllOpt}}{}%
}}


\newcommand{\ottdruleJAXXAllNil}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \vdash  \ottnt{A}  \ottsym{*}  \ottnt{C}}%
\ottpremise{\ottnt{T}  \ottsym{=}    | \ottnt{B} |  ^\forall }%
\ottpremise{\ottnt{Ts}  \ottsym{=} \, \ottkw{itoa} \, \; | \;  \ottnt{C}  \; | \;}%
}{
\Gamma  \ottsym{;}  \ottkw{nil}  \vdash  \ottmv{x}  \ottsym{:}   \forall  \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{B}   \, \bullet \,  \ottnt{C}  \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{B}  \ottsym{[}  \ottmv{X}  \mapsto  \ottnt{C}  \ottsym{]}}{%
{\ottdrulename{JA\_AllNil}}{}%
}}


\newcommand{\ottdruleJAXXAnd}[1]{\ottdrule[#1]{%
\ottpremise{\Gamma  \ottsym{;}  \ottmv{z}  \vdash  \ottmv{x}  \ottsym{:}  \ottnt{A}  \, \bullet \,  \ottnt{p}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{1}}}}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{A'}}%
\ottpremise{\Gamma  \ottsym{;}  \ottmv{z}  \vdash  \ottmv{x}  \ottsym{:}  \ottnt{B}  \, \bullet \,  \ottnt{p}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{2}}}}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{B'}}%
}{
\Gamma  \ottsym{;}  \ottmv{z}  \vdash  \ottmv{x}  \ottsym{:}  \ottnt{A}  \, \& \,  \ottnt{B}  \, \bullet \,  \ottnt{p}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{1}}}}  \ottsym{;}  \ottnt{J_{{\mathrm{2}}}}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{A'}  \, \& \,  \ottnt{B'}}{%
{\ottdrulename{JA\_And}}{}%
}}

\newcommand{\ottdefndapp}[1]{\begin{ottdefnblock}[#1]{$\Gamma  \ottsym{;}  \ottnt{dst}  \vdash  \ottmv{x}  \ottsym{:}  \ottnt{A}  \, \bullet \,  \ottnt{p}  \, \rightsquigarrow \,  \ottnt{J}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{B}$}{\ottcom{Distributive application}}
\ottusedrule{\ottdruleJAXXNil{}}
\ottusedrule{\ottdruleJAXXOpt{}}
\ottusedrule{\ottdruleJAXXTop{}}
\ottusedrule{\ottdruleJAXXArrow{}}
\ottusedrule{\ottdruleJAXXArrowEquiv{}}
\ottusedrule{\ottdruleJAXXArrowOpt{}}
\ottusedrule{\ottdruleJAXXArrowNil{}}
\ottusedrule{\ottdruleJAXXAll{}}
\ottusedrule{\ottdruleJAXXAllOpt{}}
\ottusedrule{\ottdruleJAXXAllNil{}}
\ottusedrule{\ottdruleJAXXAnd{}}
\end{ottdefnblock}}

%% defn dproj
\newcommand{\ottdruleJPXXTop}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil  \ottnt{A}  \lceil }%
}{
\ottmv{x}  \ottsym{:}  \ottnt{A}  \, \bullet \,  \ottsym{\{}  \ell  \ottsym{\}}  \, \rightsquigarrow \,   \varnothing   \; | \;  \ottmv{z}  \ottsym{:}   \top }{%
{\ottdrulename{JP\_Top}}{}%
}}


\newcommand{\ottdruleJPXXRcdEq}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{T}  \ottsym{=}  \ottsym{\{}  \ell  \ottsym{:}   | \ottnt{A} |   \ottsym{\}}}%
}{
\ottmv{x}  \ottsym{:}  \ottsym{\{}  \ell  \ottsym{:}  \ottnt{A}  \ottsym{\}}  \, \bullet \,  \ottsym{\{}  \ell  \ottsym{\}}  \, \rightsquigarrow \,  \mathtt{code}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{A}}{%
{\ottdrulename{JP\_RcdEq}}{}%
}}


\newcommand{\ottdruleJPXXRcdNeq}[1]{\ottdrule[#1]{%
\ottpremise{ \ell_{{\mathrm{1}}}  \neq  \ell_{{\mathrm{2}}} }%
\ottpremise{\ottnt{T}  \ottsym{=}  \ottsym{\{}  \ell  \ottsym{:}   | \ottnt{A} |   \ottsym{\}}}%
}{
\ottmv{x}  \ottsym{:}  \ottsym{\{}  \ell_{{\mathrm{1}}}  \ottsym{:}  \ottnt{A}  \ottsym{\}}  \, \bullet \,  \ottsym{\{}  \ell_{{\mathrm{2}}}  \ottsym{\}}  \, \rightsquigarrow \,   \varnothing   \; | \;  \ottmv{z}  \ottsym{:}   \top }{%
{\ottdrulename{JP\_RcdNeq}}{}%
}}


\newcommand{\ottdruleJPXXAnd}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{x}  \ottsym{:}  \ottnt{A}  \, \bullet \,  \ottsym{\{}  \ell  \ottsym{\}}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{1}}}}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{A'}}%
\ottpremise{\ottmv{x}  \ottsym{:}  \ottnt{B}  \, \bullet \,  \ottsym{\{}  \ell  \ottsym{\}}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{2}}}}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{B'}}%
}{
\ottmv{x}  \ottsym{:}  \ottnt{A}  \, \& \,  \ottnt{B}  \, \bullet \,  \ottsym{\{}  \ell  \ottsym{\}}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{1}}}}  \ottsym{;}  \ottnt{J_{{\mathrm{2}}}}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{A'}  \, \& \,  \ottnt{B'}}{%
{\ottdrulename{JP\_And}}{}%
}}

\newcommand{\ottdefndproj}[1]{\begin{ottdefnblock}[#1]{$\ottmv{x}  \ottsym{:}  \ottnt{A}  \, \bullet \,  \ottsym{\{}  \ell  \ottsym{\}}  \, \rightsquigarrow \,  \ottnt{J}  \; | \;  \ottmv{z}  \ottsym{:}  \ottnt{B}$}{\ottcom{Distributive projection}}
\ottusedrule{\ottdruleJPXXTop{}}
\ottusedrule{\ottdruleJPXXRcdEq{}}
\ottusedrule{\ottdruleJPXXRcdNeq{}}
\ottusedrule{\ottdruleJPXXAnd{}}
\end{ottdefnblock}}

%% defn csub0
\newcommand{\ottdruleJSZeroXXSub}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{x}  \ottsym{:}  \ottnt{A}  \ottsym{<:}   ^+  \, \ottmv{y}  \ottsym{:}  \ottnt{B}  \, \rightsquigarrow \,  \ottnt{J}}%
}{
\ottmv{x}  \ottsym{:}  \ottnt{A}  \ottsym{<:}  \ottmv{y}  \ottsym{:}  \ottnt{B}  \, \rightsquigarrow \,  \ottnt{J}}{%
{\ottdrulename{JS0\_Sub}}{}%
}}


\newcommand{\ottdruleJSZeroXXInt}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{T}  \ottsym{=}   |  \mathbb{Z}  | }%
\ottpremise{\ottmv{x}  \ottsym{:}  \ottnt{A}  \ottsym{<:}   ^+  \, \ottmv{y}  \ottsym{:}   \mathbb{Z}   \, \rightsquigarrow \,  \ottnt{J}}%
}{
\ottmv{x}  \ottsym{:}  \ottnt{A}  \ottsym{<:}  \ottmv{y}  \ottsym{:}   \mathbb{Z}   \, \rightsquigarrow \,  \mathtt{code}}{%
{\ottdrulename{JS0\_Int}}{}%
}}


\newcommand{\ottdruleJSZeroXXVar}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{T}  \ottsym{=}   | \ottmv{X} | }%
\ottpremise{\ottmv{x}  \ottsym{:}  \ottnt{A}  \ottsym{<:}   ^+  \, \ottmv{y}  \ottsym{:}  \ottmv{X}  \, \rightsquigarrow \,  \ottnt{J}}%
}{
\ottmv{x}  \ottsym{:}  \ottnt{A}  \ottsym{<:}  \ottmv{y}  \ottsym{:}  \ottmv{X}  \, \rightsquigarrow \,  \mathtt{code}}{%
{\ottdrulename{JS0\_Var}}{}%
}}

\newcommand{\ottdefncsubZero}[1]{\begin{ottdefnblock}[#1]{$\ottmv{x}  \ottsym{:}  \ottnt{A}  \ottsym{<:}  \ottmv{y}  \ottsym{:}  \ottnt{B}  \, \rightsquigarrow \,  \ottnt{J}$}{\ottcom{Coercive subtyping}}
\ottusedrule{\ottdruleJSZeroXXSub{}}
\ottusedrule{\ottdruleJSZeroXXInt{}}
\ottusedrule{\ottdruleJSZeroXXVar{}}
\end{ottdefnblock}}

%% defn csub
\newcommand{\ottdruleJSXXEquiv}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{A}  \fallingdotseq  \ottnt{B}}%
}{
\ottmv{x}  \ottsym{:}  \ottnt{A}  \ottsym{<:}   ^+  \, \ottmv{y}  \ottsym{:}  \ottnt{B}  \, \rightsquigarrow \,  \mathtt{code}}{%
{\ottdrulename{JS\_Equiv}}{}%
}}


\newcommand{\ottdruleJSXXTop}[1]{\ottdrule[#1]{%
\ottpremise{ \rceil  \ottnt{B}  \lceil }%
}{
\ottmv{x}  \ottsym{:}  \ottnt{A}  \ottsym{<:}  ^\pm \, \ottmv{y}  \ottsym{:}  \ottnt{B}  \, \rightsquigarrow \,   \varnothing }{%
{\ottdrulename{JS\_Top}}{}%
}}


\newcommand{\ottdruleJSXXBot}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{T}  \ottsym{=}   | \ottnt{A} | }%
}{
\ottmv{x}  \ottsym{:}   \bot   \ottsym{<:}  ^\pm \, \ottmv{y}  \ottsym{:}  \ottnt{A}  \, \rightsquigarrow \,  \mathtt{code}}{%
{\ottdrulename{JS\_Bot}}{}%
}}


\newcommand{\ottdruleJSXXInt}[1]{\ottdrule[#1]{%
}{
\ottmv{x}  \ottsym{:}   \mathbb{Z}   \ottsym{<:}   ^+  \, \ottmv{y}  \ottsym{:}   \mathbb{Z}   \, \rightsquigarrow \,  \mathtt{code}}{%
{\ottdrulename{JS\_Int}}{}%
}}


\newcommand{\ottdruleJSXXIntAnd}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{T}  \ottsym{=}   |  \mathbb{Z}  | }%
}{
\ottmv{x}  \ottsym{:}   \mathbb{Z}   \ottsym{<:}   ^-  \, \ottmv{y}  \ottsym{:}   \mathbb{Z}   \, \rightsquigarrow \,  \mathtt{code}}{%
{\ottdrulename{JS\_IntAnd}}{}%
}}


\newcommand{\ottdruleJSXXVar}[1]{\ottdrule[#1]{%
}{
\ottmv{x}  \ottsym{:}  \ottmv{X}  \ottsym{<:}  ^\pm \, \ottmv{y}  \ottsym{:}  \ottmv{X}  \, \rightsquigarrow \,  \mathtt{code}}{%
{\ottdrulename{JS\_Var}}{}%
}}


\newcommand{\ottdruleJSXXArrow}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{T_{{\mathrm{1}}}}  \ottsym{=}   \overrightarrow{  | \ottnt{A_{{\mathrm{2}}}} |  } }%
\ottpremise{\ottnt{T_{{\mathrm{2}}}}  \ottsym{=}   \overrightarrow{  | \ottnt{B_{{\mathrm{2}}}} |  } }%
\ottpremise{\ottnt{Ts}  \ottsym{=} \, \ottkw{itoa} \, \; | \;  \ottnt{A_{{\mathrm{1}}}}  \; | \;}%
\ottpremise{\ottmv{x_{{\mathrm{1}}}}  \ottsym{:}  \ottnt{B_{{\mathrm{1}}}}  \ottsym{<:}  \ottmv{y_{{\mathrm{1}}}}  \ottsym{:}  \ottnt{A_{{\mathrm{1}}}}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{1}}}}}%
\ottpremise{\ottmv{x_{{\mathrm{2}}}}  \ottsym{:}  \ottnt{A_{{\mathrm{2}}}}  \ottsym{<:}  \ottmv{y_{{\mathrm{2}}}}  \ottsym{:}  \ottnt{B_{{\mathrm{2}}}}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{2}}}}}%
}{
\ottmv{x}  \ottsym{:}  \ottnt{A_{{\mathrm{1}}}}  \rightarrow  \ottnt{A_{{\mathrm{2}}}}  \ottsym{<:}  ^\pm \, \ottmv{y}  \ottsym{:}  \ottnt{B_{{\mathrm{1}}}}  \rightarrow  \ottnt{B_{{\mathrm{2}}}}  \, \rightsquigarrow \,  \mathtt{code}}{%
{\ottdrulename{JS\_Arrow}}{}%
}}


\newcommand{\ottdruleJSXXAll}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{T_{{\mathrm{1}}}}  \ottsym{=}    | \ottnt{A_{{\mathrm{2}}}} |  ^\forall }%
\ottpremise{\ottnt{T_{{\mathrm{2}}}}  \ottsym{=}    | \ottnt{B_{{\mathrm{2}}}} |  ^\forall }%
\ottpremise{\ottnt{B_{{\mathrm{1}}}}  \ottsym{<:}  \ottnt{A_{{\mathrm{1}}}}}%
\ottpremise{\ottmv{x_{{\mathrm{0}}}}  \ottsym{:}  \ottnt{A_{{\mathrm{2}}}}  \ottsym{<:}  \ottmv{y_{{\mathrm{0}}}}  \ottsym{:}  \ottnt{B_{{\mathrm{2}}}}  \, \rightsquigarrow \,  \ottnt{J}}%
}{
\ottmv{x}  \ottsym{:}   \forall  \ottmv{X} \!*\! \ottnt{A_{{\mathrm{1}}}} .\; \ottnt{A_{{\mathrm{2}}}}   \ottsym{<:}  ^\pm \, \ottmv{y}  \ottsym{:}   \forall  \ottmv{X} \!*\! \ottnt{B_{{\mathrm{1}}}} .\; \ottnt{B_{{\mathrm{2}}}}   \, \rightsquigarrow \,  \mathtt{code}}{%
{\ottdrulename{JS\_All}}{}%
}}


\newcommand{\ottdruleJSXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{T_{{\mathrm{1}}}}  \ottsym{=}  \ottsym{\{}  \ell  \ottsym{:}   | \ottnt{A} |   \ottsym{\}}}%
\ottpremise{\ottnt{T_{{\mathrm{2}}}}  \ottsym{=}  \ottsym{\{}  \ell  \ottsym{:}   | \ottnt{B} |   \ottsym{\}}}%
\ottpremise{\ottmv{x_{{\mathrm{0}}}}  \ottsym{:}  \ottnt{A}  \ottsym{<:}  \ottmv{y_{{\mathrm{0}}}}  \ottsym{:}  \ottnt{B}  \, \rightsquigarrow \,  \ottnt{J}}%
}{
\ottmv{x}  \ottsym{:}  \ottsym{\{}  \ell  \ottsym{:}  \ottnt{A}  \ottsym{\}}  \ottsym{<:}  ^\pm \, \ottmv{y}  \ottsym{:}  \ottsym{\{}  \ell  \ottsym{:}  \ottnt{B}  \ottsym{\}}  \, \rightsquigarrow \,  \mathtt{code}}{%
{\ottdrulename{JS\_Rcd}}{}%
}}


\newcommand{\ottdruleJSXXSplit}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{B_{{\mathrm{1}}}}  \lhd\, \ottnt{B} \,\rhd  \ottnt{B_{{\mathrm{2}}}} }%
\ottpremise{\ottmv{y_{{\mathrm{1}}}}  \ottsym{:}  \ottnt{B_{{\mathrm{1}}}}  \; \rhd \;  \ottmv{z}  \ottsym{:}  \ottnt{B}  \; \lhd \;  \ottmv{y_{{\mathrm{2}}}}  \ottsym{:}  \ottnt{B_{{\mathrm{2}}}}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{3}}}}}%
\ottpremise{\ottmv{x}  \ottsym{:}  \ottnt{A}  \ottsym{<:}  ^\pm \, \ottmv{y_{{\mathrm{1}}}}  \ottsym{:}  \ottnt{B_{{\mathrm{1}}}}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{1}}}}}%
\ottpremise{\ottmv{x}  \ottsym{:}  \ottnt{A}  \ottsym{<:}  ^\pm \, \ottmv{y_{{\mathrm{2}}}}  \ottsym{:}  \ottnt{B_{{\mathrm{2}}}}  \, \rightsquigarrow \,  \ottnt{J_{{\mathrm{2}}}}}%
}{
\ottmv{x}  \ottsym{:}  \ottnt{A}  \ottsym{<:}  ^\pm \, \ottmv{z}  \ottsym{:}  \ottnt{B}  \, \rightsquigarrow \,  \mathtt{code}}{%
{\ottdrulename{JS\_Split}}{}%
}}


\newcommand{\ottdruleJSXXAndL}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{x}  \ottsym{:}  \ottnt{A}  \ottsym{<:}   ^-  \, \ottmv{y}  \ottsym{:}  \ottnt{C}  \, \rightsquigarrow \,  \ottnt{J}}%
}{
\ottmv{x}  \ottsym{:}  \ottnt{A}  \, \& \,  \ottnt{B}  \ottsym{<:}  ^\pm \, \ottmv{y}  \ottsym{:}  \ottnt{C}  \, \rightsquigarrow \,  \ottnt{J}}{%
{\ottdrulename{JS\_AndL}}{}%
}}


\newcommand{\ottdruleJSXXAndR}[1]{\ottdrule[#1]{%
\ottpremise{\ottmv{x}  \ottsym{:}  \ottnt{B}  \ottsym{<:}   ^-  \, \ottmv{y}  \ottsym{:}  \ottnt{C}  \, \rightsquigarrow \,  \ottnt{J}}%
}{
\ottmv{x}  \ottsym{:}  \ottnt{A}  \, \& \,  \ottnt{B}  \ottsym{<:}  ^\pm \, \ottmv{y}  \ottsym{:}  \ottnt{C}  \, \rightsquigarrow \,  \ottnt{J}}{%
{\ottdrulename{JS\_AndR}}{}%
}}

\newcommand{\ottdefncsub}[1]{\begin{ottdefnblock}[#1]{$\ottmv{x}  \ottsym{:}  \ottnt{A}  \ottsym{<:}  ^\pm \, \ottmv{y}  \ottsym{:}  \ottnt{B}  \, \rightsquigarrow \,  \ottnt{J}$}{\ottcom{Coercive subtyping}}
\ottusedrule{\ottdruleJSXXEquiv{}}
\ottusedrule{\ottdruleJSXXTop{}}
\ottusedrule{\ottdruleJSXXBot{}}
\ottusedrule{\ottdruleJSXXInt{}}
\ottusedrule{\ottdruleJSXXIntAnd{}}
\ottusedrule{\ottdruleJSXXVar{}}
\ottusedrule{\ottdruleJSXXArrow{}}
\ottusedrule{\ottdruleJSXXAll{}}
\ottusedrule{\ottdruleJSXXRcd{}}
\ottusedrule{\ottdruleJSXXSplit{}}
\ottusedrule{\ottdruleJSXXAndL{}}
\ottusedrule{\ottdruleJSXXAndR{}}
\end{ottdefnblock}}

%% defn cmerge
\newcommand{\ottdruleJMXXAnd}[1]{\ottdrule[#1]{%
}{
\ottmv{z}  \ottsym{:}  \ottnt{A}  \; \rhd \;  \ottmv{z}  \ottsym{:}  \ottnt{A}  \, \& \,  \ottnt{B}  \; \lhd \;  \ottmv{z}  \ottsym{:}  \ottnt{B}  \, \rightsquigarrow \,   \varnothing }{%
{\ottdrulename{JM\_And}}{}%
}}


\newcommand{\ottdruleJMXXArrow}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{T}  \ottsym{=}   \overrightarrow{  | \ottnt{B} |  } }%
\ottpremise{\ottnt{T_{{\mathrm{1}}}}  \ottsym{=}   \overrightarrow{  | \ottnt{B_{{\mathrm{1}}}} |  } }%
\ottpremise{\ottnt{T_{{\mathrm{2}}}}  \ottsym{=}   \overrightarrow{  | \ottnt{B_{{\mathrm{2}}}} |  } }%
\ottpremise{\ottmv{y_{{\mathrm{1}}}}  \ottsym{:}  \ottnt{B_{{\mathrm{1}}}}  \; \rhd \;  \ottmv{y}  \ottsym{:}  \ottnt{B}  \; \lhd \;  \ottmv{y_{{\mathrm{2}}}}  \ottsym{:}  \ottnt{B_{{\mathrm{2}}}}  \, \rightsquigarrow \,  \ottnt{J}}%
}{
\ottmv{x_{{\mathrm{1}}}}  \ottsym{:}  \ottnt{A}  \rightarrow  \ottnt{B_{{\mathrm{1}}}}  \; \rhd \;  \ottmv{z}  \ottsym{:}  \ottnt{A}  \rightarrow  \ottnt{B}  \; \lhd \;  \ottmv{x_{{\mathrm{2}}}}  \ottsym{:}  \ottnt{A}  \rightarrow  \ottnt{B_{{\mathrm{2}}}}  \, \rightsquigarrow \,  \mathtt{code}}{%
{\ottdrulename{JM\_Arrow}}{}%
}}


\newcommand{\ottdruleJMXXAll}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{T}  \ottsym{=}    | \ottnt{B} |  ^\forall }%
\ottpremise{\ottnt{T_{{\mathrm{1}}}}  \ottsym{=}    | \ottnt{B_{{\mathrm{1}}}} |  ^\forall }%
\ottpremise{\ottnt{T_{{\mathrm{2}}}}  \ottsym{=}    | \ottnt{B_{{\mathrm{2}}}} |  ^\forall }%
\ottpremise{\ottmv{y_{{\mathrm{1}}}}  \ottsym{:}  \ottnt{B_{{\mathrm{1}}}}  \; \rhd \;  \ottmv{y}  \ottsym{:}  \ottnt{B}  \; \lhd \;  \ottmv{y_{{\mathrm{2}}}}  \ottsym{:}  \ottnt{B_{{\mathrm{2}}}}  \, \rightsquigarrow \,  \ottnt{J}}%
}{
\ottmv{x_{{\mathrm{1}}}}  \ottsym{:}   \forall  \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{B_{{\mathrm{1}}}}   \; \rhd \;  \ottmv{z}  \ottsym{:}   \forall  \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{B}   \; \lhd \;  \ottmv{x_{{\mathrm{2}}}}  \ottsym{:}   \forall  \ottmv{X} \!*\! \ottnt{A} .\; \ottnt{B_{{\mathrm{2}}}}   \, \rightsquigarrow \,  \mathtt{code}}{%
{\ottdrulename{JM\_All}}{}%
}}


\newcommand{\ottdruleJMXXRcd}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{T}  \ottsym{=}  \ottsym{\{}  \ell  \ottsym{:}   | \ottnt{A} |   \ottsym{\}}}%
\ottpremise{\ottnt{T_{{\mathrm{1}}}}  \ottsym{=}  \ottsym{\{}  \ell  \ottsym{:}   | \ottnt{A_{{\mathrm{1}}}} |   \ottsym{\}}}%
\ottpremise{\ottnt{T_{{\mathrm{2}}}}  \ottsym{=}  \ottsym{\{}  \ell  \ottsym{:}   | \ottnt{A_{{\mathrm{2}}}} |   \ottsym{\}}}%
\ottpremise{\ottmv{y_{{\mathrm{1}}}}  \ottsym{:}  \ottnt{A_{{\mathrm{1}}}}  \; \rhd \;  \ottmv{y}  \ottsym{:}  \ottnt{A}  \; \lhd \;  \ottmv{y_{{\mathrm{2}}}}  \ottsym{:}  \ottnt{A_{{\mathrm{2}}}}  \, \rightsquigarrow \,  \ottnt{J}}%
}{
\ottmv{x_{{\mathrm{1}}}}  \ottsym{:}  \ottsym{\{}  \ell  \ottsym{:}  \ottnt{A_{{\mathrm{1}}}}  \ottsym{\}}  \; \rhd \;  \ottmv{z}  \ottsym{:}  \ottsym{\{}  \ell  \ottsym{:}  \ottnt{A}  \ottsym{\}}  \; \lhd \;  \ottmv{x_{{\mathrm{2}}}}  \ottsym{:}  \ottsym{\{}  \ell  \ottsym{:}  \ottnt{A_{{\mathrm{2}}}}  \ottsym{\}}  \, \rightsquigarrow \,  \mathtt{code}}{%
{\ottdrulename{JM\_Rcd}}{}%
}}

\newcommand{\ottdefncmerge}[1]{\begin{ottdefnblock}[#1]{$\ottmv{x}  \ottsym{:}  \ottnt{A}  \; \rhd \;  \ottmv{z}  \ottsym{:}  \ottnt{C}  \; \lhd \;  \ottmv{y}  \ottsym{:}  \ottnt{B}  \, \rightsquigarrow \,  \ottnt{J}$}{\ottcom{Coercive merging}}
\ottusedrule{\ottdruleJMXXAnd{}}
\ottusedrule{\ottdruleJMXXArrow{}}
\ottusedrule{\ottdruleJMXXAll{}}
\ottusedrule{\ottdruleJMXXRcd{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsCompilation}{
\ottdefncompile{}\ottdefndapp{}\ottdefndproj{}\ottdefncsubZero{}\ottdefncsub{}\ottdefncmerge{}}

\newcommand{\ottdefnss}{
\ottdefnsAlgorithmics
\ottdefnsSubtyping
\ottdefnsTyping
\ottdefnsSemantics
\ottdefnsCompilation
}

\newcommand{\ottall}{\ottmetavars\\[0pt]
\ottgrammar\\[5.0mm]
\ottdefnss}

